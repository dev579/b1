<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta http-equiv='cache-control' content='no-cache'> 
    <meta http-equiv='expires' content='0'> 
    <meta http-equiv='pragma' content='no-cache'>

<title>b1</title>
<meta property="og:title" content="b1" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://dev579.github.io/b1/" />
<meta property="og:url" content="https://dev579.github.io/b1/" />
<meta property="og:site_name" content="b1" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="b1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"b1","name":"b1","url":"https://dev579.github.io/b1/"}</script>
<!--<link rel="stylesheet" href="/b1/assets/css/style.css?v=486378b5600bfe1d4855a57d61a2e59a7e76da4a"> -->
<link rel="stylesheet" href="/b1/css/default-normalize.css?v=01">

<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
<link rel="stylesheet" href="/b1/css/tokyo-night-dark.css">  
<link rel="stylesheet" href="/b1/css/custom.css">      
<style>    
    body {background-color: #222; color: #fff;}
</style>
</head>
<body>
    <div class="container-lg px-3 my-5 markdown-body">
      
    <!--  <h1 id="b1"></h1>     -->

        <h2 id="b1">Разделы Bitrix</h2> 

        <h3>Вывести все разделы в которых находится элемент инфоблока (CIBlockElement::GetElementGroups)</h3>

        <pre><code class="language-php">

          $ElementId = $arResult['ID'];
              $db_groups = CIBlockElement::GetElementGroups($ElementId, true);
              while($ar_group = $db_groups->Fetch()) {
                  echo 'Все товары: <a href="/catalog/'. $ar_group["ID"] . '/">';
                  echo $ar_group["NAME"];
                  echo "</a>";
          }

        </code></pre>



        <h3>Как получить родительский раздел-Bitrix?</h3>

        <pre><code class="language-php">

          Метод возвращает путь по дереву от корня до раздела SECTION_ID

          $navChain = CIBlockSection::GetNavChain($IBLOCK_ID, $SectionID); 
          while ($arNav=$navChain->GetNext()): echo "<pre>"; print_r($arNav); echo "</pre>";
          
          
          ист: https://www.cyberforum.ru/1c-bitrix/thread1778864.html (blog)
          
          
          еще можно посмотреть здесь:
          - https://qna.habr.com/q/577186 (Как получить корневой раздел элемента инфоблока?)
          
          
          ---
          
          
          Варианты решения задачи: 
          
          Получение самого верхнего родительского раздела инфоблока
          
          
          Нам нужно определить, является ли текущий раздел, в котором находится пользователь, корневым. Для этого воспользуемся методом CIBlockSection::GetNavChain - возвращает путь по дереву от корня до раздела SECTION_ID
          
          $navChain = CIBlockSection::GetNavChain(
            $arParams["IBLOCK_ID"], 
            $arResult['VARIABLES']['SECTION_ID']
          )
          while ($arNav = $navChain->Fetch()) {
                var_dump($arNav);
          }
          
          
          В var_dump получим всю цепочку разделов, начиная с корневого.
          
          Далее: нужно получить ID корневого раздела и сопоставить с текущим. Просто оборвем цикл while на первой итерации, сопоставим разделы и создадим переменную для дальнейшего сравнения.
          
          
          $navChain = CIBlockSection::GetNavChain(
            $arParams["IBLOCK_ID"], 
            $arResult['VARIABLES']['SECTION_ID']
          );
          while ($arNav = $navChain->Fetch()) {
            if ($arResult['VARIABLES']['SECTION_ID'] == $arNav['ID']) {
              $itMainSection = true;
            }
          break;}
          
          
          Здесь мы создали переменную $itMainSection при условии если текущий раздел совпал с корневым. Дальше, просто, обворачиваем фильтр в условие.
          
          
          if ($itMainSection) {
            $APPLICATION->IncludeComponent(
                  "bitrix:catalog.smart.filter",
                 ...
                   Компонент фильтра
                 ...
              );
          }
          
          
          Если переменная $itMainSection существует, значит пользователь находится в корневом разделе и выводится умный фильтр.

        </code></pre>



        <h2 id="b2">"Элементы разделов Bitrix</h2> 

        <h3>Вывести все разделы в которых находится элемент инфоблока / GetElementGroups - Bitrix</h3>

        <pre><code class="language-php">

          Вывести все разделы в которых находится элемент инфоблока

          $ElementId = $arResult['ID'];
              $db_groups = CIBlockElement::GetElementGroups($ElementId, true);
              while($ar_group = $db_groups->Fetch()) {
                  echo 'Все товары: <a href="/catalog/'. $ar_group["ID"] . '/">';
                  echo $ar_group["NAME"];
                  echo "</a>";
          }
          
        </code></pre>





















      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    
   <!-- <script>anchors.add();</script> -->
    <script>hljs.highlightAll();</script>

  </body>
</html>
